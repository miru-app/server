/*
	UNFINISHED
	WILL LIKELY NEVER BE FINISHED
	KWIK USES IP-BASED SIGNATURES AND REJECTS REQUESTS FROM DIFFERENT IPS
	THAT MAKES THIS HOST USELESS TO US
*/

const string = `<!doctype html>
<html class="no-js" lang="">
<head>
<meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<title>AnimePahe_Tensei_shitara_Slime_Datta_Ken_-_03_720p_HorribleSubs.mp4</title>
<meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="x-dns-prefetch-control" content="on">
<link rel="dns-prefetch" href="//cdn.kwik.cx">
<link rel="dns-prefetch" href="//s1.kwik.cx">
<link rel="dns-prefetch" href="//s2.kwik.cx">
<link href="//cdn.jsdelivr.net/combine/npm/bulma@0.7.2/css/bulma.min.css,npm/plyr@3/dist/plyr.min.css" rel="stylesheet">
<style>/* @font-face{font-family:'Font Awesome 5 Free';font-style:normal;font-weight:900;src:url(../fonts/fa-solid-900.woff) format("woff")}.fa,.fas{font-family:'Font Awesome 5 Free';font-weight:900}.fa,.fab,.fal,.far,.fas{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:inline-block;font-style:normal;font-variant:normal;text-rendering:auto;line-height:1}.fa-stack{display:inline-block;height:2em;line-height:2em;position:relative;vertical-align:middle;width:2em}.fa-stack-1x,.fa-stack-2x{left:0;position:absolute;text-align:center;width:100%}.fa-stack-1x{line-height:inherit}.fa-stack-2x{font-size:2em}.fa-inverse{color:#fff}.fa-500px:before{content:"\f26e"}.fa-circle:before{content:"\f111"}.fa-redo-alt:before{content:"\f2f9"} */html{background:#000;line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0;font-family:BlinkMacSystemFont,-apple-system,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue","Helvetica","Arial",sans-serif}.jw-rightclick{display:none!important}.jw-knob{background-color:rgb(255,255,255)!important}.click-to-load{position:absolute;width:100%;height:100%;top:0;left:0;cursor:pointer;z-index:4;background:#000;color:#fff}.click-to-load .reload{position:absolute;top:0;right:0;bottom:0;left:0;text-align:center;width:160px;height:100px;margin:auto}.click-to-load .icon{font-size:2rem}.embed-responsive{position:relative;display:block;width:100%;padding:0;overflow:hidden}.embed-responsive::before{display:block;content:""}.embed-responsive-21by9::before{padding-top:42.857143%}.embed-responsive-16by9::before{padding-top:56.25%}.embed-responsive-4by3::before{padding-top:75%}.embed-responsive-1by1::before{padding-top:100%}.embed-responsive{position:relative;display:block;width:100%;padding:0;overflow:hidden}.embed-responsive::before{display:block;content:""}.embed-responsive-item,.plyr{position:absolute;top:0;bottom:0;left:0;width:100%;height:100%;border:0}.embed-responsive-21by9::before{padding-top:42.857143%}.embed-responsive-16by9::before{padding-top:56.25%}.embed-responsive-4by3::before{padding-top:75%}.embed-responsive-1by1::before{padding-top:100%}.plyr{background:#000}.plyr::after{content:" ";position:absolute;width:72px;height:24px;z-index:9;top:15px;right:15px;background:url(https://cdn.kwik.cx/img/kwik-white2.png) 99% 0 no-repeat;background-size:100% 100%}.plyr.plyr--paused::after{opacity:1;transition:opacity .25s ease-in}.plyr.plyr--playing::after{opacity:.25;transition:opacity 1s ease-out 5s}.plyr .plyr__video-wrapper{width:100%;height:100%}.plyr video{position:absolute;height:100%}.plyr--full-ui.plyr--video .plyr__control--overlaid,.plyr--audio .plyr__control.plyr__tab-focus,.plyr--audio .plyr__control:hover,.plyr--audio .plyr__control[aria-expanded=true],.plyr__control--overlaid:focus,.plyr__control--overlaid:hover,.plyr--video .plyr__controls .plyr__control.plyr__tab-focus,.plyr--video .plyr__controls .plyr__control:hover,.plyr--video .plyr__controls .plyr__control[aria-expanded=true],.plyr__menu__container label.plyr__control input[type=radio]:checked+span{background: #00d1b2}.plyr--full-ui input[type=range]{color: #00d1b2}.plyr__time:hover{cursor:pointer}.plyr__volume[hidden]{display:-webkit-box!important;display:-ms-flexbox!important;display:flex!important}.plyr__volume[hidden] button.plyr__control[hidden]{display:-webkit-box!important;display:-ms-flexbox!important;display:flex!important}@media  screen and (max-width:768px){.modal-card,.modal-content{max-height:100%;margin:0 30px}.modal .box{padding:1rem}.modal-close{top:0;right:0}}</style>


<script type="text/javascript" data-cfasync="false">
/*<![CDATA[/* */
/* Generated 2019-01-31 18:55:45 for "PopAds%20CGAPIL%20A", len 1630 */
 (function(){ var u=window;u["\x5fpop"]=[["\x73i\u0074\u0065I\x64",2834082],["m\u0069\u006e\x42\x69\x64",0],["\u0070\u006f\x70\x75n\x64er\x73Pe\x72I\x50",0],["d\x65\u006ca\x79\u0042\u0065\x74\u0077\x65\u0065n",0],["\x64\x65f\x61\u0075\u006ct",false],["\u0064e\u0066a\u0075\u006ctP\u0065r\x44\u0061\u0079",0],["\u0074opm\x6f\u0073\x74\x4c\u0061\u0079er",!1]];var t=["/\x2fc1\u002e\x70o\u0070ads.\u006eet/\x70o\u0070\x2e\x6a\x73","\x2f\x2fc\x32\u002ep\u006f\u0070a\x64\x73\u002e\x6eet\x2f\x70\u006fp\x2ejs","//\u0077ww.\u0072\u006b\u0075e\u0069\x66\u0069zv\x6d\u0077b\u0069\x2eco\x6d/x\x2e\x6a\u0073","\x2f/\u0077\x77\x77.\x6buv\x6c\u0069\x6b\x67\x65k\u0065\x6b\u0077p\u002e\x63o\u006d\u002f\u0072\x67\x6a\u0079\x2e\x6a\x73",""],o=0,m,y=function(){if(""==t[o])return;m=u["\u0064\u006f\x63\x75\u006den\x74"]["\u0063\x72eateEl\x65\x6d\u0065nt"]("\x73\u0063\u0072\u0069\u0070t");m["\x74\u0079\x70\u0065"]="\u0074\x65\u0078t\x2f\x6a\u0061v\u0061s\x63\u0072\u0069pt";m["as\u0079\x6ec"]=!0;var w=u["\x64oc\u0075\x6d\x65nt"]["\u0067\x65\x74E\u006c\u0065\x6d\x65n\u0074s\u0042yT\x61\x67N\x61\u006de"]("\u0073c\u0072\u0069p\u0074")[0];m["\x73r\u0063"]=t[o];if(o<2){m["cr\u006fss\u004f\u0072\u0069gi\x6e"]="\u0061n\u006f\x6eym\u006fu\u0073";m["in\x74\u0065gr\x69\x74\u0079"]="s\u0068\u0061\x325\u0036\u002d\x6b\u004fx\u0063\x4b\u006f\x55\x50\x56\u0073tzW\x519\u0031\x57\x508\u004fE\u004aZ\u0067\u0074\x4d\u006fX\u0042\u0043b\u0032\u006c\u0068\x32\u0046p\u0078\x4cK\x4f\u004e\x41\u003d"};m["\u006f\x6e\x65r\x72\x6f\u0072"]=function(){o++;y()};w["\x70a\u0072\u0065n\u0074\u004e\x6fd\x65"]["in\x73e\x72\x74Be\x66\x6f\u0072\u0065"](m,w)};y()})();
/*]]>/* */
</script>
</head>
<body>
<div class="embed-responsive embed-responsive-16by9">
<video id="kwikPlayer" controls playsinline></video>
</div>
<script src="//cdn.jsdelivr.net/combine/npm/jquery@3,npm/plyr@3"></script>
<script src="/app/js/downstream.js"></script>
<script>eval(function(p,a,c,k,e,d){e=function(c){return(c<a?'':e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))};if(!''.replace(/^/,String)){while(c--){d[e(c)]=k[c]||e(c)}k=[function(e){return d[e]}];e=function(){return'\\w+'};c=1};while(c--){if(k[c]){p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c])}}return p}('f $7={H:a(2){4 B(9.7.h(y z("(?:(?:^|.*;)\\\\s*"+d(2).h(/[\\-\\.\\+\\*]/g,"\\\\$&")+"\\\\s*\\\\=\\\\s*([^;]*).*$)|^.*$"),"$1"))||G},E:a(2,q,3,6,5,t){k(!2||/^(?:8|r\\-v|o|m|p)$/i.D(2)){4 w}f b="";k(3){F(3.J){j K:b=3===P?"; 8=O, I N Q M:u:u A":"; r-v="+3;n;j L:b="; 8="+3;n;j S:b="; 8="+3.Z();n}}9.7=d(2)+"="+d(q)+b+(5?"; m="+5:"")+(6?"; o="+6:"")+(t?"; p":"");4 x},Y:a(2,6,5){k(!2||!11.C(2)){4 w}9.7=d(2)+"=; 8=12, R 10 W l:l:l A"+(5?"; m="+5:"")+(6?"; o="+6:"");4 x},C:a(2){4(y z("(?:^|;\\\\s*)"+d(2).h(/[\\-\\.\\+\\*]/g,"\\\\$&")+"\\\\s*\\\\=")).D(9.7)},X:a(){f c=9.7.h(/((?:^|\\s*;)[^\\=]+)(?=;|$)|^\\s*|\\s*(?:\\=[^;]*)?(?:\\1|$)/g,"").T(/\\s*(?:\\=[^;]*)?;\\s*/);U(f e=0;e<c.V;e++){c[e]=B(c[e])}4 c}};',62,65,'||sKey|vEnd|return|sDomain|sPath|cookie|expires|document|function|sExpires|aKeys|encodeURIComponent|nIdx|var||replace||case|if|00|domain|break|path|secure|sValue|max||bSecure|59|age|false|true|new|RegExp|GMT|decodeURIComponent|hasItem|test|setItem|switch|null|getItem|31|constructor|Number|String|23|Dec|Fri|Infinity|9999|01|Date|split|for|length|1970|keys|removeItem|toUTCString|Jan|this|Thu'.split('|'),0,{}));eval(function(p,a,c,k,e,d){e=function(c){return(c<a?'':e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))};if(!''.replace(/^/,String)){while(c--){d[e(c)]=k[c]||e(c)}k=[function(e){return d[e]}];e=function(){return'\\w+'};c=1};while(c--){if(k[c]){p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c])}}return p}('F 0=C B("#A",{"z":{"y":7},"x":5,"8":{"v":"3"},"t":{"s":7},});0.q={"b":"c","p":"f-a.1","o":[{"n":"d://D.3.6/8/e/G:U:E:S:R:Q:P:O/N/f-a.1","b":"c/1"},],"L":"d://i.3.6/J/I/H.T",};$("#j-2 .k-u").l("g",m(h){0.K();0.9();4()});$("#j-2 .k-2").l("g",m(h){0.M=w(r);0.9();4()});',57,57,'player|mp4|resume|kwik|closeModals||cx|true|storage|play|_03_720p_HorribleSubs|type|video|https||AnimePahe_Tensei_shitara_Slime_Datta_Ken_|click|event||modal|button|on|function|src|sources|title|source|resumeAt|iosNative|fullscreen|reset|key|parseInt|seekTime|global|keyboard|kwikPlayer|Plyr|new|s1|8101|const|2601|fc5fb891bf14bb4cb4c975b275ed08271b1a659c8f967225d1634e6c13f9c557|0004|snapshot|restart|poster|currentTime|72yxNUsEWMnq4gj2ZAovVnN28Wlw0No58rBlPUH1bc2um6Vb|ba90|78b1|f108|91cb|5750|jpg|343'.split('|'),0,{}))
</script>


<script async src="//www.googletagmanager.com/gtag/js?id=UA-120526557-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-120526557-1');
  </script>
</body>
</html>`;

const REGEX = /'player\|.*\|([\d\w_-]*)\|type\|.*\|([\d\w_-]*)\|click\|.*\|new\|([\d\w]*)\|(\d*)\|/gm;

const parts = REGEX.exec(string);
parts.input = ''; // Easier reading
parts[0] = ''; // Easier reading
console.log(parts);

const server = parts[3];
const ip = parts[0];
const signature = parts[0];
const fileName = `${parts[2]}-${parts[1]}`;

const stream = `https://${server}.kwik.cx/storage/e/${ip}/${signature}/${fileName}.mp4`;
console.log(stream);

/*
https://s1.kwik.cx/storage/e/2601:343:8101:5750:91cb:f108:78b1:ba90/72yxNUsEWMnq4gj2ZAovVnN28Wlw0No58rBlPUH1bc2um6Vb/AnimePahe_Tensei_shitara_Slime_Datta_Ken_-_03_720p_HorribleSubs.mp4
*/